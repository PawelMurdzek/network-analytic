title: Metasploit Reverse Shell Connection
id: c3d4e5f6-3333-4444-5555-666677778888
status: experimental
description: |
  Detects connections to port 4444, the default port for Metasploit 
  reverse shell payloads. This is a strong indicator of compromise.
  MITRE ATT&CK: T1059 - Command and Scripting Interpreter
author: Security Team
date: 2024/11/30
references:
  - https://attack.mitre.org/techniques/T1059/
  - https://www.metasploit.com/
logsource:
  category: network
  product: flow
detection:
  selection:
    DestinationPort: 4444
  condition: selection
level: critical
tags:
  - attack.execution
  - attack.t1059
  - attack.command_and_control
falsepositives:
  - Some legitimate applications may use port 4444
  - Development environments
fields:
  - src_ip
  - dst_ip
  - src_port
  - dst_port
